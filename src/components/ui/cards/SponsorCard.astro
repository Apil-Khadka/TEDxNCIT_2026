---
interface SponsorCardProps {
  sponsor: {
    id: string;
    name: string;
    type: string;
    description: string;
    longDescription: string;
    url: string;
    img: any; // Changed from { src: string } to any to handle ImageMetadata
  };
  tier?: 'gold' | 'silver' | 'bronze' | 'default';
  size?: 'large' | 'medium' | 'small';
}

const { sponsor, tier = 'default', size = 'medium' } = Astro.props;

// Enhanced tier styling with better differentiation and glow overlays
const tiers = {
  gold: { 
    border: 'border-yellow-400 dark:border-yellow-500',
    borderHover: 'hover:border-yellow-500 dark:hover:border-yellow-400',
    shadow: 'shadow-xl hover:shadow-2xl',
    glowHover: 'group-hover:shadow-[0_0_80px_rgba(250,204,21,0.4)] dark:group-hover:shadow-[0_0_100px_rgba(250,204,21,0.3)]',
    bgCard: 'bg-gradient-to-br from-white via-yellow-50/30 to-amber-50/40 dark:from-neutral-900 dark:via-yellow-950/20 dark:to-amber-950/30',
    badge: 'bg-gradient-to-r from-yellow-500 to-amber-600 text-white',
    titleColor: 'text-gray-900 dark:text-yellow-50',
    descColor: 'text-gray-700 dark:text-gray-300',
    imgBg: 'bg-gradient-to-br from-gray-50/50 to-gray-100/50 dark:from-neutral-900/50 dark:to-neutral-800/50',
    imgFilter: 'group-hover:scale-105',
    overlayGlow: 'bg-yellow-100 dark:bg-yellow-900/20'
  },
  silver: { 
    border: 'border-slate-300 dark:border-slate-600',
    borderHover: 'hover:border-slate-400 dark:hover:border-slate-500',
    shadow: 'shadow-lg hover:shadow-xl',
    glowHover: 'group-hover:shadow-[0_0_50px_rgba(148,163,184,0.25)] dark:group-hover:shadow-[0_0_60px_rgba(148,163,184,0.2)]',
    bgCard: 'bg-white dark:bg-neutral-850',
    badge: 'bg-gradient-to-r from-slate-500 to-gray-600 text-white',
    titleColor: 'text-slate-800 dark:text-slate-200',
    descColor: 'text-slate-600 dark:text-slate-400',
    imgBg: 'bg-gradient-to-br from-gray-50/50 to-gray-100/50 dark:from-neutral-900/50 dark:to-neutral-800/50',
    imgFilter: 'grayscale opacity-70 group-hover:grayscale-0 group-hover:opacity-100 group-hover:scale-105',
    overlayGlow: 'bg-slate-100 dark:bg-slate-800/30'
  },
  bronze: { 
    border: 'border-orange-400 dark:border-orange-600',
    borderHover: 'hover:border-orange-500 dark:hover:border-orange-500',
    shadow: 'shadow-md hover:shadow-lg',
    glowHover: 'group-hover:shadow-[0_0_40px_rgba(251,146,60,0.2)] dark:group-hover:shadow-[0_0_50px_rgba(251,146,60,0.15)]',
    bgCard: 'bg-white dark:bg-neutral-875',
    badge: 'bg-gradient-to-r from-orange-500 to-amber-600 text-white',
    titleColor: 'text-orange-800 dark:text-orange-200',
    descColor: 'text-orange-700/80 dark:text-orange-300/80',
    imgBg: 'bg-gradient-to-br from-gray-50/50 to-gray-100/50 dark:from-neutral-900/50 dark:to-neutral-800/50',
    imgFilter: 'grayscale opacity-70 group-hover:grayscale-0 group-hover:opacity-100 group-hover:scale-105',
    overlayGlow: 'bg-orange-100 dark:bg-orange-900/20'
  },
  default: { 
    border: 'border-gray-200 dark:border-neutral-700',
    borderHover: 'hover:border-gray-300 dark:hover:border-neutral-600',
    shadow: 'shadow-sm hover:shadow-md',
    glowHover: '',
    bgCard: 'bg-white dark:bg-neutral-800',
    badge: 'bg-gray-500 text-white',
    titleColor: 'text-gray-800 dark:text-gray-200',
    descColor: 'text-gray-600 dark:text-gray-400',
    imgBg: 'bg-gray-50 dark:bg-neutral-900/50',
    imgFilter: 'opacity-70 group-hover:opacity-100',
    overlayGlow: 'bg-gray-100 dark:bg-gray-800/30'
  }
};

// Size configurations
const sizes = {
  large: {
    container: 'min-h-[450px]',
    layout: 'flex-col lg:flex-row',
    imageArea: 'w-full lg:w-2/5 min-h-[280px]',
    textArea: 'w-full lg:w-3/5 p-10 lg:p-12',
    title: 'text-4xl lg:text-5xl',
    desc: 'text-base lg:text-lg line-clamp-4',
    button: 'text-base'
  },
  medium: {
    container: 'min-h-[380px]',
    layout: 'flex-col',
    imageArea: 'w-full min-h-[180px]',
    textArea: 'w-full p-6',
    title: 'text-2xl lg:text-3xl',
    desc: 'text-sm line-clamp-3',
    button: 'text-sm'
  },
  small: {
    container: 'min-h-[320px]',
    layout: 'flex-col',
    imageArea: 'w-full min-h-[140px]',
    textArea: 'w-full p-5',
    title: 'text-xl',
    desc: 'text-xs line-clamp-2',
    button: 'text-sm'
  }
};

const currentTier = tiers[tier];
const currentSize = sizes[size];
const isLarge = size === 'large';
---

<div class="swiper-slide !h-auto">
  <div class="h-full py-6 px-2">
    <button
      onclick={`window.openModal('${sponsor.id}')`}
      class={`relative overflow-hidden h-full w-full rounded-2xl border-2 transition-all duration-500 cursor-pointer group ${currentTier.border} ${currentTier.borderHover} ${currentTier.shadow} ${currentTier.glowHover} ${currentTier.bgCard} ${currentSize.container} flex flex-col`}
    >
      {/* Decorative Glow Overlay */}
      <div class={`absolute top-0 right-0 -mt-20 -mr-20 w-80 h-80 ${currentTier.overlayGlow} rounded-full blur-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-700 pointer-events-none`}></div>

      {/* Card Content */}
      <div class={`flex relative z-10 h-full ${currentSize.layout}`}>
        
        {/* Image Area */}
        <div class={`flex items-center justify-center p-8 ${currentTier.imgBg} ${currentSize.imageArea} ${!isLarge && 'border-b-2 border-gray-100 dark:border-neutral-800'}`}>
          <img 
            src={sponsor.img.src} 
            alt={sponsor.name} 
            class={`max-h-full max-w-full object-contain transition-all duration-500 ${currentTier.imgFilter}`}
          />
        </div>

        {/* Text Area */}
        <div class={`flex flex-col justify-center text-left ${currentSize.textArea} flex-grow`}>
          
          {/* Badge */}
          <div class="mb-3">
            <span class={`inline-block px-3 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider ${currentTier.badge}`}>
              {sponsor.type}
            </span>
          </div>

          {/* Title */}
          <h3 class={`font-bold mb-3 ${currentSize.title} ${currentTier.titleColor}`}>
            {sponsor.name}
          </h3>
          
          {/* Description */}
          <p class={`leading-relaxed ${currentSize.desc} ${currentTier.descColor}`}>
            {sponsor.description}
          </p>

          {/* View Details Button */}
          <div class={`mt-auto pt-6 flex items-center gap-2 font-semibold ${currentTier.titleColor} opacity-0 group-hover:opacity-100 transition-all duration-300 transform translate-y-2 group-hover:translate-y-0 ${currentSize.button}`}>
            <span>View Details</span>
            <span class="text-xl leading-none">â†’</span>
          </div>
        </div>
      </div>

      {/* Hidden data for modal */}
      <div
        id={`data-${sponsor.id}`}
        class="hidden"
        data-tier={tier}
        data-name={sponsor.name}
        data-desc={sponsor.description}
        data-long-desc={sponsor.longDescription}
        data-img={sponsor.img.src}
        data-url={sponsor.url}
        data-type={sponsor.type}
      ></div>
    </button>
  </div>
</div>

<style>
  /* Custom neutral shades */
  :global(.dark .bg-neutral-850) {
    background-color: rgb(23, 23, 23);
  }
  
  :global(.dark .bg-neutral-875) {
    background-color: rgb(20, 20, 20);
  }

  /* Line clamp utilities */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
  
  .line-clamp-4 {
    display: -webkit-box;
    -webkit-line-clamp: 4;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
